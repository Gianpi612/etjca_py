<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Autovalutazione | Domanda {{ idx + 1 }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            primary: '#4F46E5'
          },
          boxShadow: {
            card: '0 25px 50px -20px rgba(79,70,229,.25)',
            cta: '0 20px 40px rgba(79,70,229,.35)'
          }
        }
      }
    }
  </script>
</head>

<body class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-sky-50 antialiased flex items-center justify-center px-4">

<main class="w-full max-w-3xl bg-white rounded-3xl shadow-card border border-slate-100 overflow-hidden">

  <!-- Progress -->
  <div class="h-2 w-full bg-slate-100">
    <div class="h-full bg-indigo-500 transition-all duration-700" style="width: {{ progresso }}%"></div>
  </div>

  <div class="p-8 sm:p-12">

    <!-- Header -->
    <header class="flex items-center justify-between mb-10">
      <div class="text-xs uppercase tracking-widest font-semibold text-slate-400">
        Domanda {{ idx + 1 }} di {{ totale }}
      </div>
      <span class="text-xs px-3 py-1 rounded-full bg-indigo-100 text-indigo-700 font-semibold">
        {{ progresso }}%
      </span>
    </header>

    <!-- Question -->
    <h1 class="text-3xl sm:text-4xl font-extrabold text-slate-900 leading-tight mb-12">
      {{ domanda.text }}
    </h1>

    <!-- Options -->
    <form method="POST" class="space-y-4">
      {% for opzione in opzioni %}
      <label class="group flex items-center gap-5 p-5 sm:p-6 rounded-2xl border border-slate-200 cursor-pointer
                    transition-all duration-200
                    hover:border-indigo-300 hover:bg-indigo-50/40
                    peer-checked:border-indigo-600 peer-checked:bg-indigo-50">

        <input type="radio"
               name="risposta"
               value="{{ opzione.valore }}"
               {% if session['risposte'].get(domanda.id) == opzione.valore %}checked{% endif %}
               class="peer hidden" />

        <span class="w-6 h-6 rounded-full border-2 border-slate-300 flex items-center justify-center
                     peer-checked:border-indigo-600 peer-checked:bg-indigo-600 transition">
          <span class="w-2.5 h-2.5 bg-white rounded-full opacity-0 peer-checked:opacity-100"></span>
        </span>

        <span class="text-lg text-slate-700 font-medium group-hover:text-slate-900 peer-checked:text-slate-900">
          {{ opzione.label }}
        </span>
      </label>
      {% endfor %}

      <!-- Footer -->
      <div class="mt-14 pt-8 border-t border-slate-100 flex flex-col-reverse sm:flex-row justify-between gap-4">

        {% if idx > 0 %}
        <button name="action" value="back"
                class="px-6 py-3 rounded-xl text-slate-500 font-semibold hover:text-slate-900 hover:bg-slate-100 transition">
          ← Indietro
        </button>
        {% else %}
        <div></div>
        {% endif %}

        <button name="action" value="next" type="submit"
                class="bg-indigo-600 text-white text-lg font-bold px-10 py-4 rounded-xl shadow-cta
                       hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center gap-3">
          {% if idx + 1 == totale %}
            Concludi
          {% else %}
            Continua
          {% endif %}
          →
        </button>

      </div>
    </form>

  </div>
</main>

</body>
</html>